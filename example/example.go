package main

import (
	"fmt"
	"github.com/kunlun-qilian/jwt"
	"time"
)

func main() {
	jwtMgr := jwt.NewJwtMgr(`LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBbGpoN3ZQWWhzR1Ywa3NVMXRhV2VLSWxIc1phSTYvbjdDNStYTzJ5TVBEenpQaVdCCllWKy94UFdwQ253eVdVdDVoWk5samJxVTV5MlR3SHM3OXRJaHpyay9zalBSck5PSjE3cVpoK3pTcUF4NFZCK3AKc3ZYR2lYVytOZTRBc3UwU09zamhVZGJhR3NEVWppY21UTVlyeHlpNytZZm16UkFJTDluY0wrREZ0UWpEUVh0ZwpObUhHMVU2MUNlbW5tdHhDdzZYQkdMSHUwd01oblJ5dlFlSlhOOW1tQ0JZYnNjSTNUQ0lXeXRoYWtVenJIdFVyCm5ESlJKZG5IUngzY2ptMi9LUHdUT2xsSW1saDNRRFJOQXM4OTIzenF6R1pVTG8wb3VCcUthOUFjOWxtTXExTWMKQitkeXdCaFhnUGtHL1hmdkpqNENvYVRTUDVGTTYwcHVYdWxVK1FJREFRQUJBb0lCQUZwSDZmM2Z3dEY3dC9xNQpjUlVSU3lNN2xnM2gxYnBVaTQ4cHc3OGY5b3dCYVlMUkVaZk83cmJWbVZsRzJRK1hiNXBhd203U1VzazVPQkkzClBndVJzR1hJS2NMVXA5QUJkbGRqdXYvWTBhWFRrTUdtSWR2L0grbmZESWptMkI2d29nTVlWV3BWQU5HUlVHMTYKaytjU05wOUVHT3pYdzFzOHBsN3p4UVExUnowTDhtSnAyTEwxSEJ5UnlmbDRJVDIvYzIwNTFlWWFKY3hUamFubgpIMlpjNWxFT3dtN0NMcWk2NWNRVE1IZW5zMzdTOHBPOFVxVXU5SDN2NzZpcGs0L21ZRUJMdC8rRUs3N0ExbU1hCjBXQ0ZXaDNXOG5HVExyM3M1aGNDWVVwOEY2Z1k1MDkyeGFvV3J5Nncwdnh5YkdpNGM2QjZzNVczOWdkNGtHTmYKb1BURUlURUNnWUVBeUFDclQraGxsNjVqZWpaR2Y4eTJJajVONGE4MVg2Q3JjUlFMZXBwRWpHM3lVRHhFZHhyMwp5REw5am1HUFUxOXpQeWNsaWhJMzV0UHdsbFUvRGRpSHNucHNJR3RRWmJMa0tER25TbzV0UWtJaC9vRzM5U3NKCjNZcmhPVkVFeUVnY3ZNK0N1Q2ZBb0xmcW5jNWl6WFZ1WlQ4RU5sUi9Sby94OS85dlk4NUZWSFVDZ1lFQXdFZW4Kdy9Fb3NXdFNSV0ZoUy83eGgvVXNmSzFMOFdWb1hIUWJmSENUWlJWSGNyajQrYy83MGo1T3lJU1ZIK0IzUUltZgpVOWlNUzJvL3lCVXdDMm5zMVlxV1VQRGxoVEY3SnVpOXhEbWx4cXZubGUyVlROTytPMlBEK2p0WGdCakUya0Z3CiswanFvZCs1bXdMZUJ0Mno5bTEzYlVtUmZpVUFYWUg0YmlzOVhmVUNnWUVBbGJtYWhobXVaRjBTNzV6T0xrSnMKWHpwUlI1REkzaXdEN0lWYkNvK09uYXA1YW9PVHBhNjByRlV2NkhVMHZPK0o4VTgzRlNRS1lXMXNnTDZVazZMMApBek1PMno0N1U4Y1djdGlwS25GeGJkYmdhQTFvVDh2R2VPbk5MZ0Z2R1JpVEd1NG1LQUxxZStielp1dm9uM000CkQrZWJHYWtzRndFUDNkNkYzeXUrVHprQ2dZQTQ1RHE0V0IrQk4wNzFabFhDaGFGelo5Q001ejJrSkN3WHh1Ym4KRCt3Y3FZb2xZS09TVHI2a3UzaldEWnlOL1AxcjVBeDNZNGhIUEIyNUZzUExiTUQ5Z2U3dDdna0xPdFBFZEhMSgpuNEQwWXFLNEVyN3RKMjJPNXZyeWpDSmNyWGQ1V0ltVVlFUEVONDBVVjJuWVFEcmlQQXR0RTZwdjE0VGZKZmlhCnFFS1ZEUUtCZ0RuNktnSEU2NmY2VmR3UjFYN3R2WkVSOUo5d1pUWmJCZHpLZm81OWs4M0lRUXRFY0dxbnM2N0kKaXRuM1NZR3htUk5La2VzazNBQ2pKbTNEZyszTjNxakYrZjR1MTMyMmNTc3JCc2dQUEZIMGtwcGlyQS9tNmsvagowdmxBU1ZBa05WbHpZM3RONXJxRWtER2RFL21PNnE2ZlhMUkZkY201RGh2TzcwcHdhOUNhCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==`)
	jwtMgr.Init()
	tokenByte, _ := jwtMgr.SignToken("test-client", "jwt provider", "jwt provider", time.Now().Add(time.Second*5))
	auth := jwt.Authorizations{}
	auth.Add("Bearer", string(tokenByte))
	tokenStr := auth.String()
	fmt.Println("token: ", tokenStr)

	parseTokenStr := jwt.ParseAuthorization(tokenStr).Get("Bearer")
	fmt.Println("parse token:", parseTokenStr)
	token, err := jwtMgr.ParseToken(parseTokenStr)
	if err != nil {
		panic(err)
	}
	fmt.Println(token.Audience(), token.Subject(), token.Issuer(), jwtMgr.TokenExpired(token))

	time.Sleep(time.Second * 6)

	fmt.Println("expired ", token.Audience(), token.Subject(), token.Issuer(), jwtMgr.TokenExpired(token))
}
